<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andy Final Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden; /* Prevent scrolling */
        }
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 200vh; 
            background: linear-gradient(to bottom, white 50%, #add8e6 51%);
        }
        #myImg01 {
            position: absolute;
            width: 100px;
            height: 80px;
            top: 400px;
            left: 150px;
        }
    </style>
</head>
<body onkeydown="handleKeyDown(event)" onkeyup="handleKeyUp(event)">

<div id="gameContainer">
    <h1 align="center" style="position: absolute; top: 20px; width: 100%; color: black;">Andy Final Game</h1>

    <!-- Character -->
    <img id="myImg01" src="MainCharacterRight.png" />

    <!-- Win/Lose Triggers -->
    <img id="myImg02" style="position: absolute; width: 100px; height: 80px; top: 500px; left: 250px;" src="myImage02.jpg" />
    <img id="myImg03" style="position: absolute; width: 100px; height: 80px; top: 50px; left: 400px;" src="myImage03.jpg" />

    <!-- Platform -->
    <div class="platform" style="position: absolute; width: 200px; height: 20px; top: 1200px; left: 300px; background-color: grey;"></div>
</div>

<script>
    // Global variables
    let isJumping = false;
    let keyState = {}; // Track key states
    const characterSpeed = 3;
    const jumpHeight = 130;
    const gravity = 5;

    function handleKeyDown(event) {
        keyState[event.key] = true; // Track key press
        if (event.key === "w" && !isJumping) myJump();
    }

    function handleKeyUp(event) {
        keyState[event.key] = false; // Track key release
    }

    function setCharacter(action) {
        const myImg = document.getElementById("myImg01");
        if (!isJumping) myImg.src = `MainCharacter${action}.png`; // Change the sprite
    }

    function gameLoop() {
        const myImg = document.getElementById("myImg01");

        // Handle horizontal movement
        if (keyState["d"]) {
            setCharacter("Right");
            myImg.style.left = (parseInt(myImg.style.left, 10) + characterSpeed) + "px";
        }
        if (keyState["a"]) {
            setCharacter("Left");
            myImg.style.left = (parseInt(myImg.style.left, 10) - characterSpeed) + "px";
        }

        requestAnimationFrame(gameLoop);
    }

    function myJump() {
        if (isJumping) return;
        isJumping = true;

        const myImg = document.getElementById("myImg01");
        const startPos = parseInt(myImg.style.top, 10);
        let currentHeight = 0;

        myImg.src = 'MainCharacterJump.png';

        function jumpUp() {
            if (currentHeight < jumpHeight) {
                currentHeight += gravity;
                myImg.style.top = (startPos - currentHeight) + "px";
                requestAnimationFrame(jumpUp);
            } else {
                jumpDown();
            }
        }

        function jumpDown() {
            currentHeight -= gravity;
            myImg.style.top = (startPos - currentHeight) + "px";

            if (currentHeight <= 0) {
                myImg.style.top = startPos + "px"; // Land
                isJumping = false;
                myImg.src = 'MainCharacterRight.png';
            } else {
                requestAnimationFrame(jumpDown);
            }
        }

        jumpUp();
    }

    // Start the game loop
    gameLoop();
</script>
</body>
</html>
